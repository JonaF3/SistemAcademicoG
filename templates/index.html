{% extends "base.html" %}

{% block page_title %}Dashboard Principal{% endblock %}
{% block title %}Dashboard - Sistema AcadÃ©mico{% endblock %}

{% block content %}
<!-- EstadÃ­sticas RÃ¡pidas -->
<div class="stats-grid">
    <div class="stat-card" style="background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);">
        <h4>TOTAL ESTUDIANTES</h4>
        <div class="value">{{ estudiantes|length }}</div>
    </div>
    <div class="stat-card" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
        <h4>MATRICULADOS</h4>
        <div class="value">{{ estudiantes|selectattr('estado_matricula', 'equalto', 'matriculado')|list|length }}</div>
    </div>
    <div class="stat-card" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">
        <h4>PENDIENTES</h4>
        <div class="value">{{ estudiantes|selectattr('estado_matricula', 'equalto', 'no_matriculado')|list|length }}</div>
    </div>
    <div class="stat-card" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);">
        <h4>PROFORMAS</h4>
        <div class="value">{{ proformas|length }}</div>
    </div>
</div>

<!-- SecciÃ³n de Estudiantes -->
<div class="section-header">
    <div class="section-icon">ğŸ‘¨â€ğŸ“</div>
    <h2>Estudiantes Registrados</h2>
</div>

{% if estudiantes %}
<div class="table-card-list">
    {% for estudiante in estudiantes %}
    <div class="table-card">
        <div class="table-card-item">
            <div class="table-card-label">CÃ³digo</div>
            <div class="table-card-value" style="color: #3b82f6; font-weight: 700;">{{ estudiante.codigo_estudiante }}</div>
        </div>
        <div class="table-card-item">
            <div class="table-card-label">Estudiante</div>
            <div class="table-card-value">{{ estudiante.nombre }} {{ estudiante.apellido }}</div>
        </div>
        <div class="table-card-item">
            <div class="table-card-label">CÃ©dula</div>
            <div class="table-card-value">{{ estudiante.cedula }}</div>
        </div>
        <div class="table-card-item">
            <div class="table-card-label">Curso</div>
            <div class="table-card-value">{{ estudiante.curso }}</div>
        </div>
        <div class="table-card-item">
            <div class="table-card-label">Email</div>
            <div class="table-card-value" style="font-size: 0.9em;">{{ estudiante.email }}</div>
        </div>
        <div class="table-card-item">
            <div class="table-card-label">Estado</div>
            <span class="badge {{ estudiante.estado_matricula.replace('_', '-') }}">
                {{ estudiante.estado_matricula.replace('_', ' ').title() }}
            </span>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="empty-state">
    <div class="empty-state-icon">ğŸ‘¨â€ğŸ“</div>
    <p><strong>No hay estudiantes registrados</strong></p>
    <p style="margin-top: 10px; font-size: 0.95em;">Comienza agregando tu primer estudiante al sistema</p>
</div>
{% endif %}

<!-- SecciÃ³n de Proformas -->
<div class="section-header" style="margin-top: 60px;">
    <div class="section-icon">ğŸ“‹</div>
    <h2>Proformas Generadas</h2>
</div>

{% if proformas %}
<div class="table-card-list">
    {% for proforma in proformas %}
    <div class="table-card">
        <div class="table-card-item">
            <div class="table-card-label">NÂ° Proforma</div>
            <div class="table-card-value" style="color: #3b82f6; font-weight: 700;">{{ proforma.numero_proforma }}</div>
        </div>
        <div class="table-card-item">
            <div class="table-card-label">Estudiante</div>
            <div class="table-card-value">{{ proforma.nombre }} {{ proforma.apellido }}</div>
        </div>
        <div class="table-card-item">
            <div class="table-card-label">CÃ³digo</div>
            <div class="table-card-value">{{ proforma.codigo_estudiante }}</div>
        </div>
        <div class="table-card-item">
            <div class="table-card-label">Curso</div>
            <div class="table-card-value">{{ proforma.curso }}</div>
        </div>
        <div class="table-card-item">
            <div class="table-card-label">Monto</div>
            <div class="table-card-value" style="color: #10b981; font-weight: 700; font-size: 1.1em;">
                ${{ "%.2f"|format(proforma.monto) }}
            </div>
        </div>
        <div class="table-card-item">
            <div class="table-card-label">Fecha</div>
            <div class="table-card-value">{{ proforma.fecha_generacion[:10] }}</div>
        </div>
        <div class="table-card-item">
            <div class="table-card-label">Estado</div>
            <span class="badge {{ proforma.estado }}">{{ proforma.estado.title() }}</span>
        </div>
        <div class="table-card-item">
            <div class="table-card-label">Acciones</div>
            <a href="{{ url_for('ver_proforma', numero_proforma=proforma.numero_proforma) }}" class="btn-action">
                ğŸ“„ Ver Detalles
            </a>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="empty-state">
    <div class="empty-state-icon">ğŸ“‹</div>
    <p><strong>No hay proformas generadas</strong></p>
    <p style="margin-top: 10px; font-size: 0.95em;">Las proformas aparecerÃ¡n aquÃ­ una vez que los estudiantes las generen</p>
</div>
{% endif %}

{% endblock %}